# Sonification model 제작하기
* Sonification이란?: 데이터나 정보를 소리로 변환하여 전달하는 기술.
* 시-청각 전이를 통해 색각 이상자가 색을 '들을 수' 있도륵 하는 보조도구를 만들어보자.
파일 경로는 내 로컬 기준이라 니들 로컬에선 실행 안됨.
## 어떤 모델임?
그니까 색을 들을 수 있게 하는 모델임. 빨간색의 소리는 어떠한가... 
말도 안 되는 것처럼 보일 수도 있지만, 사실 소니피케이션은 NASA에서도 그렇고 시각적인 자료를 쉽게 이해하기 힘들 때 생각보다 많이 사용한다고 함.

그래서 어떻게 하냐면.. 원래는 색이란게 가시광선 영역에서의 특정 파장을 의미하는 거잖아? 그래서 걍 파장 영역 별로 소리 주파수에 할당하려고 했음.

근데 생각해보니까. 색도 색 나름이라 똑같은 빨간색이라도 좀 느낌이 다를 수도 있잖아?
그래서 HSV(색상, 채도, 명도)에 따라 음색, 높낮이, 크기에 따라 보다 세밀하게 조정하기로 함.. 사실 여기까지만 해도 비교적 간단할 텐데..

근데 또 생각해보니까 그래봤자 사람이 듣는 건 '삐-' 거리는 기계음 일텐데 사람이 이걸 듣고 색상을 경험하는 건 말도 안 되고 애초에 일상에서 그냥 빨강 화면만 마주하는 경우는 없기에 현실성이 매우 떨어진다고 판단함.

그래서 여러 종합적인 요소를 판단하여, 샘플 이미지에서 **인간이 느낄 수 있는 감정**을 추출하기로 했음.
그리고 그 감정에 따라 음색(악기)을 결정하고, 거기에 HSV에 따라 클러스터링을 통해 이미지에서 영역을 구분한 후 mp3재생.

## 파이프라인
1. 오픈AI에서 개발한 임베딩을 생성해주는 모델은 CLIP을 이용하여 '감정 강도' 및 '핵심 감정' 추출
2. 추출한 '핵심 감정'에 따라 심리학 모델의 연속적 스케일 설정 및 음향 매핑을 통해 이미지에 사용될 악기와 음게, 그리고 셈여림 결정. 그리고 파일 선택.
    (Valence 긍정과 부정-조성 및 음역대, Arousal 긴장도-셈여림, Warmth 따뜻함-악기군 선택)
3. 이미지를 K-means clustering을 통해 영역 구분. 영역별로 평균 HSV 계산 및 Json 파일 생성.
4. HSV에 따라 mp3 재생방식 결정.
5. 실행: 해당 샘플이미지가 화면에 띄워지면, 클러스터링으로 구분 된 영역 표시. 마우스 커서를 올려두면 소리 연속 재생  
    (인터렉션 및 공간 소니피케이션 구현)

## 파일 별 설명 
* Clip.py; 오픈AI에서 개발한 Clip이란 모델을 이용하여 이미지의 감정 추출
* clustering.py; k-means clustering을 이용하여 이미지 영역 구분하고 픽셀 별 HSV 값 계산
* clustering_road; mplcursors와 matpoltlib 이용하여 실행 창 구현하기
* sound_select; 사운드 파일 선택 함수. main.py가 이 파일에서 일부 함수를 가져다 씀.
* instrument_path; 이미지 파일 파싱함수. 이미지 파일 넣어서 속성 확인하는 함수.
* main.py; 전체 코드
## 원리
### CLIP은 어떻게 이미지에서 '감정 강도'를 추출할 수 있었을까?
CLIP에서 나온 '감정 강도'의 값은 **코사인 유사도(cosine similarity)**를 이용함.

코사인 유사도란, 두 벡터의 유사도를 스칼라 곱을 이용해 나타내는 방식임.
(사진)
CLIP에선 각각 이미지 인코더와 텍스트 인코더를 이용하여 **이미지 벡터(Image Embedding), 감정 텍스트 벡터(Text Embedding)**를 같은 차원(보통 512차원이라고 함.)의 벡터로 마련함. 그리고 기존의 학습되어 있던 감정 텍스트와 여러 샘플 사진들의 **통계적 위치 관계**를 이용하여 두 벡터의 코사인 유사도를 이용하여 '감정 정도'를 파악해냄.(참고로 CLIP은 각각의 감정 텍스트와 이미지를 수 억개 정도 학습한 모델임.)

쉽게 말하자면 CLIP이 감정을 판단하는게 아니라, **이미지를 대표하는 벡터와 감정을 대표하는 벡터 사이의 각도를 재는 것.**
### K-means Clustering; 영역분할


"C:\Users\sk926\Downloads\stanley-park-4539852_1280.jpg"